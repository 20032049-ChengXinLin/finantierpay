<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>FinantierPay - Forgot Password</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet">
<link href="/font-awesome/css/fontawesome.min.css" rel="stylesheet" />
<link href="/font-awesome/css/brands.min.css" rel="stylesheet" />
<link href="/font-awesome/css/solid.min.css" rel="stylesheet" />
<script src="/bootstrap/css/bootstrap.js"></script>
<script src="/bootstrap/js/bootstrap.bundle.min.js"></script>
<style th:replace="fragments/FinantierPay_style"></style>
</head>
<body>
	<div th:replace="fragments/FinantierPay_header"></div>
	<section class="container mb-3">
		<div class="row">
			<div class="d-flex justify-content-center">
				<div class="col-md-4 col-md-offset-4">
					<div class="card">
						<div class="card-header text-center">
							<h2 class="text-center">Reset Your Password</h2>
						</div>
						<div class="card-body">
							<form class="needs-validation" th:action="@{/reset_password}"
								method="post" style="max-width: 350px; margin: 0 auto;"
								novalidate>
								<input type="hidden" name="token" th:value="${token}" />
								<div class="border border-secondary rounded p-3">
									<div class="mb-3">
										<input type="password" name="password" id="password"
											class="form-control" placeholder="Enter your new password"
											required autofocus pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$" />
										<div class="invalid-feedback">Please enter a valid
											Password</div>
										<div class="text-danger" th:if="${password}"
											th:text="${password}"></div>
										<div class="text-danger" th:if="${patternpassword}"
											th:text="${patternpassword}"></div>
									</div>
									<div class="mb-3">
										<input type="password" class="form-control"
											name="confirmpassword" placeholder="Confirm your new password" required
											oninput="checkPasswordMatch(this);" pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$" />
										<div class="invalid-feedback">Please enter a valid
											Confirm Password</div>
										<div class="text-danger" th:if="${confirmpassword}"
											th:text="${confirmpassword}"></div>
										<div class="text-danger" th:if="${matchpassword}"
											th:text="${matchpassword}"></div>
									</div>
									<p class="text-center">
										<button type="submit" class="btn btn-primary">Change
											Password</button>
									</p>
								</div>
							</form>
						</div>
						<script type="text/javascript">
							function checkPasswordMatch(fieldConfirmPassword) {
								var password = document
										.getElementById("password").value;
								if (fieldConfirmPassword.value != password) {
									fieldConfirmPassword
											.setCustomValidity("Passwords do not match!");
								} else {
									fieldConfirmPassword.setCustomValidity("");
								}
							}
							'use strict'
							var form = document
									.querySelector('.needs-validation')

							form.addEventListener('submit', function(event) {
								if (!form.checkValidity()) {
									event.preventDefault()
									event.stopPropagation()
								}
								form.classList.add('was-validated')
							})
						</script>
					</div>
				</div>
			</div>
		</div>
	</section>
	<div th:replace="fragments/FinantierPay_footer"></div>
</body>
</html>